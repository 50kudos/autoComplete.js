var a,b;a=this,b=function(){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o,s=function(t){return"string"==typeof t?document.querySelector(t):t()},u=function(){return o.innerHTML=""},l=s,a=function(t){(o=document.createElement("ul")).setAttribute("id","autoComplete_results_list"),t.destination.insertAdjacentElement(t.position,o)},c=function(t){return'<span class="autoComplete_highlighted">'.concat(t,"</span>")},h=function(r,a,s){r.forEach(function(t,e){var n=document.createElement("li"),i=r[e].source[a]||r[e].source;n.setAttribute("data-".concat(s.tag),s.value||i),n.setAttribute("id",i),n.setAttribute("class","autoComplete_result"),n.innerHTML=r[e].match||r[e],o.appendChild(n)})},d=function(n,i,r,a){o.querySelectorAll(".autoComplete_result").forEach(function(t){t.addEventListener("mousedown",function(e){i({query:s(n).value,results:r.map(function(t){return t.source}),selection:r.find(function(t){return(t.source[a]||t.source)===e.target.closest(".autoComplete_result").id}).source}),u()})})},f=u;return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=t.threshold||0,this.renderResults=a({destination:t.renderResults?t.renderResults.destination:l(this.selector),position:t.renderResults?t.renderResults.position:"afterend"}),this.placeHolder=t.placeHolder||"",this.maxResults=t.maxResults||5,this.highlight=t.highlight||!1,this.dataAttribute={tag:t.dataAttribute?t.dataAttribute.tag:"autocomplete",value:t.dataAttribute?t.dataAttribute.value:""},this.onSelection=t.onSelection,this.init()}var t,n,i;return t=e,(n=[{key:"search",value:function(t,e){var n=this.highlight,i=e.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var r=[],a=0,s=0;s<i.length;s++){var o=i[s];a<t.length&&o===t[a]&&(o=n?c(o):o,a++),r.push(o)}return a===t.length&&r.join("")}if(i.includes(t)&&n){var u=l(this.selector).value.toLowerCase();return i.replace(u,c(u))}}},{key:"listMatchedResults",value:function(t){var n=this,i=[],r=l(this.selector).value.toLowerCase();t.filter(function(t){var e=n.search(r,t[n.data.key]||t);e&&i.push({match:e,source:t})});var e=i.slice(0,this.maxResults);return h(e,this.data.key,this.dataAttribute),e}},{key:"ignite",value:function(e){var n=this,i=this.selector,r=this.onSelection;l(i).setAttribute("placeholder",this.placeHolder);var a=l(i);a.addEventListener("keyup",function(){f();if(a.value.length>n.threshold&&a.value.replace(/ /g,"").length){var t=n.listMatchedResults(e);r&&d(i,r,t,n.data.key)}})}},{key:"init",value:function(){var e=this,t=this.data.src();t instanceof Promise?t.then(function(t){return e.ignite(t)}):this.ignite(t)}}])&&r(t.prototype,n),i&&r(t,i),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
