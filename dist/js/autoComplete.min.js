var a,b;a=this,b=function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function o(i){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?t(Object(r),!0).forEach(function(e){var t,n;t=i,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))})}return i}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,t=function(){};return{s:t,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw r}}}}function c(e,t){for(var n=document.getElementsByClassName("autoComplete_list"),i=0;i<n.length;i++)e!==n[i]&&e!==t&&n[i].parentNode.removeChild(n[i])}function a(s,u,l){for(var e,t,c=(e=u,(t=document.createElement("div")).setAttribute("id",e.resultsList.idName),t.setAttribute("aria-expanded",!0),t.setAttribute("aria-labelledby",e.resultsList.idName),t.setAttribute("class",e.resultsList.className),t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1"),e.resultsList.container&&e.resultsList.container(t),e.inputField.parentNode.appendChild(t),t),n=function(t){var e,n,i,r,o,a=s[t].match,a=(e=a,n=s[t].value,i=t,r=u.resultItem.className,o=u.resultItem.content,(a=document.createElement("div")).setAttribute("id","".concat(r,"_").concat(i)),a.setAttribute("aria-selected","false"),a.setAttribute("class",r),a.setAttribute("role","option"),a.innerHTML=e,o&&o(n,a),a);a.addEventListener("click",function(){var e={input:u.rawInputValue,query:u.queryInputValue,results:s,selection:s[t].value};l(e)}),c.appendChild(a)},i=0;i<s.length;i++)n(i);return c}function d(e,t,n){e.dispatchEvent(new CustomEvent(n,{bubbles:!0,detail:t,cancelable:!0}))}function n(e){e&&(function(e){for(var t=0;t<e.length;t++)e[t].setAttribute("aria-selected","false"),e[t].classList.remove("autoComplete_selected")}(e),h>=e.length&&(h=0),h<0&&(h=e.length-1),e[h].setAttribute("aria-selected","true"),e[h].classList.add("autoComplete_selected"))}function u(e){var t;e.target.value.trim()&&(t=(t=document.getElementById("autoComplete_list"))&&t.getElementsByTagName("div"),27===e.keyCode?c(!1,e.target):40===e.keyCode||9===e.keyCode?(e.preventDefault(),h++,n(t)):38===e.keyCode||9===e.keyCode?(e.preventDefault(),h--,n(t)):13===e.keyCode&&(e.preventDefault(),-1<h&&t&&t[h].click()),d(e.srcElement,{selection:t[h],event:e},"navigation"))}function p(o,a,s){for(var u=[],e=function(n){function e(e){var t=e?i[e]:i;t&&((t="function"==typeof s.searchEngine?s.searchEngine(o,t):function(e,t,n){var i=t.toLowerCase();if("loose"===n.searchEngine){e=e.replace(/ /g,"");for(var r=[],o=0,a=0;a<i.length;a++){var s=t[a];o<e.length&&i[a]===e[o]&&(s=n.highlight?'<span class="autoComplete_highlighted">'.concat(s,"</span>"):s,o++),r.push(s)}if(o===e.length)return r.join("")}else if(i.includes(e))return e=new RegExp("".concat(e),"i").exec(t),n.highlight?t.replace(e,'<span class="autoComplete_highlighted">'.concat(e,"</span>")):t}(o,t,s))&&e?u.push({key:e,index:n,match:t,value:i}):t&&!e&&u.push({index:n,match:t,value:i}))}var i=a[n];if(s.data.key){var t,r=l(s.data.key);try{for(r.s();!(t=r.n()).done;)e(t.value)}catch(e){r.e(e)}finally{r.f()}}else e()},t=0;t<a.length;t++)e(t);return(s.sort?u.sort(s.sort):u).slice(0,s.maxResults)}var h;return function(){function N(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,N);var t=e.name,n=void 0===t?"Search":t,i=e.selector,r=void 0===i?"#autoComplete":i,o=e.data,a=o.src,s=o.key,u=o.cache,l=void 0===u||u,c=e.query,d=e.trigger,p=(d=void 0===d?{}:d).event,h=void 0===p?["input"]:p,f=d.condition,v=void 0!==f&&f,m=e.searchEngine,b=void 0===m?"strict":m,y=e.threshold,g=void 0===y?0:y,A=e.debounce,k=void 0===A?0:A,C=e.resultsList,F=(C=void 0===C?{}:C).render,w=void 0===F||F,E=C.container,L=void 0!==E&&E,O=C.destination,j=C.position,I=void 0===j?"afterend":j,t=C.element,i=void 0===t?"ul":t,o=C.idName,u=void 0===o?"autoComplete_list":o,p=C.className,d=void 0===p?"autoComplete_list":p,f=C.navigation,m=void 0!==f&&f,y=e.sort,A=void 0!==y&&y,F=e.placeHolder,E=e.maxResults,j=void 0===E?5:E,t=e.resultItem,o=(t=void 0===t?{}:t).content,p=void 0!==o&&o,C=t.element,f=void 0===C?"li":C,y=t.idName,E=void 0===y?"autoComplete_result":y,o=t.className,C=void 0===o?"autoComplete_result":o,y=e.noResults,t=e.highlight,o=void 0!==t&&t,t=e.feedback,e=e.onSelection;this.name=n,this.selector=r,this.data={src:function(){return"function"==typeof a?a():a},key:s,cache:l},this.query=c,this.trigger={event:h,condition:v},this.searchEngine=b,this.threshold=g,this.debounce=k,this.resultsList={render:w,container:L,destination:O||this.inputField,position:I,element:i,idName:u,className:d,navigation:m},this.sort=A,this.placeHolder=F,this.maxResults=j,this.resultItem={content:p,element:f,idName:E,className:C},this.noResults=y,this.highlight=o,this.feedback=t,this.onSelection=e,this.preInit()}var e,t,n;return e=N,(t=[{key:"start",value:function(e,t,n){var i=this,r=p(n,e,this);if(d(this.inputField,{input:t,query:n,results:r},"response"),!e.length)return this.noResults();e={input:t,query:n,results:r};if(!this.resultsList.render)return this.feedback(e);r.length&&a(r,o({rawInputValue:t,queryInputValue:n},this),this.onSelection);d(this.inputField,{input:t,query:n,results:r},"rendered"),function(e,t){h=-1;var n=t||u;e.addEventListener("keydown",n)}(this.inputField,this.resultsList.navigation),document.addEventListener("click",function(e){return c(e.target,i.inputField)})}},{key:"compose",value:function(){var l=this;return new Promise(function(r,o){var a,s,u;return l.data.src().then(function(e){try{return a=e,d(l.inputField,a,"request"),i=l.inputField,s=(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement?i.value:i.innerHTML).toLowerCase(),t=s,n=l.query,u=n&&n.manipulate?n.manipulate(t):t,c(!1,l.inputField),i=l.trigger,n=u,t=l.threshold,(i.condition?i.condition(n):n.length>=t&&n.replace(/ /g,"").length)&&l.start(a,s,u),r()}catch(e){return o(e)}var t,n,i},o)})}},{key:"init",value:function(){var n,i,r,t=this;this.placeHolder&&this.inputField.setAttribute("placeholder",this.placeHolder),this.hook=(n=function(e){t.compose(e)},i=this.debounce,function(){var e=this,t=arguments;clearTimeout(r),r=setTimeout(function(){return n.apply(e,t)},i)}),this.inputField.addEventListener("input",this.hook),d(this.inputField,null,"init")}},{key:"preInit",value:function(){var o=this,a=document;new MutationObserver(function(e,t){var n,i=l(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;a.querySelector(o.selector)&&(t.disconnect(),o.inputField=a.querySelector(o.selector),(n=o).inputField.setAttribute("dir","ltr"),n.inputField.setAttribute("type","text"),n.inputField.setAttribute("spellcheck",!1),n.inputField.setAttribute("autocorrect","off"),n.inputField.setAttribute("autocomplete","off"),n.inputField.setAttribute("autocapitalize","off"),n.inputField.setAttribute("title",n.name),n.inputField.setAttribute("aria-label",n.inputName),n.inputField.setAttribute("aria-owns",n.resultItem.idName),n.inputField.setAttribute("aria-haspopup",!0),n.inputField.setAttribute("aria-autocomplete","both"),d(o.inputField,{mutation:r},"connect"),o.init())}}catch(e){i.e(e)}finally{i.f()}}).observe(a,{childList:!0,subtree:!0})}},{key:"unInit",value:function(){this.inputField.removeEventListener("input",this.hook),d(this.inputField,null,"unInit")}}])&&i(e.prototype,t),n&&i(e,n),N}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a="undefined"!=typeof globalThis?globalThis:a||self).autoCompleteJS=b();
