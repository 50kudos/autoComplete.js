var a,b;a=this,b=function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var a="data-result",u={resultsList:"autoComplete_results_list",result:"autoComplete_result",highlight:"autoComplete_highlighted"},o=function(e){return"string"==typeof e?document.querySelector(e):e()},c=function(e){return e.innerHTML=""},h=o,r=function(e){var t=document.createElement(e.element);return e.container&&(u.resultsList=e.container(t)||u.resultsList),t.setAttribute("id",u.resultsList),e.destination.insertAdjacentElement(e.position,t),t},d=function(e){return"<span class=".concat(u.highlight,">").concat(e,"</span>")},l=function(i,r,l){r.forEach(function(e,t){var n=document.createElement(l.element),s=r[t].value[e.key]||r[t].value;n.setAttribute(a,s),n.setAttribute("class",u.result),n.setAttribute("tabindex","1"),n.innerHTML=l.content?l.content(e,n):e.match||e,i.appendChild(n)})},f=function(e,n){var s=o(e),i=n.firstChild;document.onkeypress=function(e){var t=document.activeElement;switch(e.keyCode){case 38:t!==i&&t!==s?t.previousSibling.focus():t===i&&s.focus();break;case 40:t===s&&0<n.childNodes.length?i.focus():t!==n.lastChild&&t.nextSibling.focus()}}},m=c,v=function(n,s,i,r){var l=s.querySelectorAll(".".concat(u.result));Object.keys(l).forEach(function(t){["mousedown","keydown"].forEach(function(e){l[t].addEventListener(e,function(t){"mousedown"!==e&&13!==t.keyCode&&39!==t.keyCode||(i({event:t,query:o(n)instanceof HTMLInputElement?o(n).value:o(n).innerHTML,matches:r.matches,results:r.list.map(function(e){return e.value}),selection:r.list.find(function(e){return(e.value[e.key]||e.value)===t.target.closest(".".concat(u.result)).getAttribute(a)})}),c(s))})})})};return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e.selector||"#autoComplete",this.data={src:function(){return"function"==typeof e.data.src?e.data.src():e.data.src},key:e.data.key,cache:void 0===e.data.cache||e.data.cache},this.searchEngine="loose"===e.searchEngine?"loose":"strict",this.threshold=e.threshold||0,this.debounce=e.debounce||0,this.resultsList={render:!(!e.resultsList||!e.resultsList.render)&&e.resultsList.render,view:e.resultsList&&e.resultsList.render?r({container:!(!e.resultsList||!e.resultsList.container)&&e.resultsList.container,destination:e.resultsList&&e.resultsList.destination?e.resultsList.destination:h(this.selector),position:e.resultsList&&e.resultsList.position?e.resultsList.position:"afterend",element:e.resultsList&&e.resultsList.element?e.resultsList.element:"ul"}):null},this.sort=e.sort||!1,this.placeHolder=e.placeHolder,this.maxResults=e.maxResults||5,this.resultItem={content:!(!e.resultItem||!e.resultItem.content)&&e.resultItem.content,element:e.resultItem&&e.resultItem.element?e.resultItem.element:"li"},this.noResults=e.noResults,this.highlight=e.highlight||!1,this.onSelection=e.onSelection,this.dataSrc,this.init()}var e,n,s;return e=t,(n=[{key:"search",value:function(e,t){var n=this.highlight,s=t.toLowerCase();if("loose"===this.searchEngine){e=e.replace(/ /g,"");for(var i=[],r=0,l=0;l<s.length;l++){var a=t[l];r<e.length&&s[l]===e[r]&&(a=n?d(a):a,r++),i.push(a)}return r===e.length&&i.join("")}if(s.includes(e))return e=new RegExp("".concat(e),"i").exec(t),n?t.replace(e,d(e)):t}},{key:"listMatchedResults",value:function(n){var o=this;return new Promise(function(e){var u=[];n.filter(function(n,s){var e=function(e){var t=o.search(o.inputValue,n[e]||n);t&&e?u.push({key:e,index:s,match:t,value:n}):t&&!e&&u.push({index:s,match:t,value:n})};if(o.data.key){var t=!0,i=!1,r=void 0;try{for(var l,a=o.data.key[Symbol.iterator]();!(t=(l=a.next()).done);t=!0){e(l.value)}}catch(e){i=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}}else e()});var t=o.sort?u.sort(o.sort).slice(0,o.maxResults):u.slice(0,o.maxResults);return o.resultsList.render&&(l(o.resultsList.view,t,o.resultItem),f(o.selector,o.resultsList.view)),e({matches:u.length,list:t})})}},{key:"ignite",value:function(){var l=this,a=this.selector,u=h(a),e=this.placeHolder;e&&u.setAttribute("placeholder",e);var n,s,i,r=function(t){l.inputValue=u instanceof HTMLInputElement?u.value.toLowerCase():u.innerHTML.toLowerCase();var e=l.resultsList.render,n=l.inputValue.length>l.threshold&&l.inputValue.replace(/ /g,"").length,s=function(e,t){u.dispatchEvent(new CustomEvent("autoComplete",{bubbles:!0,detail:{event:e,query:l.inputValue,matches:t.matches,results:t.list},cancelable:!0}))};if(e){var i=l.onSelection,r=l.resultsList.view;m(r);n&&l.listMatchedResults(l.dataSrc).then(function(e){s(t,e),0===e.list.length&&l.noResults&&l.resultsList.render?l.noResults():i&&v(a,r,i,e)})}else!e&&n&&l.listMatchedResults(l.dataSrc).then(function(e){s(t,e)})};u.addEventListener("keyup",(n=function(t){if(l.data.cache)r(t);else{var e=l.data.src();e instanceof Promise?e.then(function(e){l.dataSrc=e,r(t)}):(l.dataSrc=e,r(t))}},s=this.debounce,function(){var e=this,t=arguments;clearTimeout(i),i=setTimeout(function(){return n.apply(e,t)},s)}))}},{key:"init",value:function(){var t=this,e=this.data.src();e instanceof Promise?e.then(function(e){t.dataSrc=e,t.ignite()}):(this.dataSrc=e,this.ignite())}}])&&i(e.prototype,n),s&&i(e,s),t}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
