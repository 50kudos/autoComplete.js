var a,b;a=this,b=function(){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var i=function(){return document.querySelector("#autoComplete")},a=function(){document.querySelector("#autoComplete_results_list").innerHTML=""},o=i,r=function(t){var e=document.createElement("ul");e.setAttribute("id","autoComplete_results_list"),t.destination.insertAdjacentElement(t.position,e)},s=function(t){return'<span class="autoComplete_highlighted_result">'.concat(t,"</span>")},l=function(a,n,r){var o=document.querySelector("#autoComplete_results_list");a.forEach(function(t,e){var i=document.createElement("li");i.setAttribute("data-".concat(r.tag),r.value||n[e]),i.setAttribute("id",n[e]),i.setAttribute("class","autoComplete_result"),i.innerHTML=a[e],o.appendChild(i)})},u=function(e){document.querySelectorAll(".autoComplete_result").forEach(function(t){t.addEventListener("mousedown",function(t){e(t.target.closest(".autoComplete_result")),i().value="",a()})})},c=a,h=function(t){document.querySelector("body").innerHTML='<div class="autoComplete_error"><strong>Error</strong>, '.concat(t,"</div>")};return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataSrc=function(){return Array.isArray(t.dataSrc)?t.dataSrc:Array.isArray(t.dataSrc())?t.dataSrc():void 0},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=Number(t.threshold)||0,this.renderResults=r(t.renderResults?{destination:t.renderResults.destination,position:t.renderResults.position}:{destination:o(),position:"afterend"}),this.placeHolder=!!String(t.placeHolder)&&t.placeHolder,this.maxResults=Number(t.maxResults)||5,this.highlight=!0===t.highlight,this.dataAttribute=t.dataAttribute===Object?{tag:t.dataAttribute.tag,value:t.dataAttribute.value}:{tag:"autocomplete",value:""},this.onSelection=t.onSelection,this.init()}var t,i,a;return t=e,(i=[{key:"search",value:function(t,e){if("loose"===this.searchEngine){t=t.replace(/ /g,"").toLowerCase();for(var i=[],a=0,n=0;n<e.length;n++){var r=e[n];a<t.length&&r.toLowerCase()===t[a]&&(this.highlight&&(r=s(r)),a++),i.push(r)}return a===t.length&&i.join("")}if(e.toLowerCase().includes(t.toLowerCase()))return this.highlight?e.toLowerCase().replace(o().value.toLowerCase(),s(o().value.toLowerCase())):e}},{key:"listMatchedResults",value:function(){var i=this;this.resList=[],this.cleanResList=[];var a=o().value;try{this.dataSrc().filter(function(t){var e=i.search(a,t);e&&(i.resList.push(e),i.cleanResList.push(t))})}catch(t){h(t)}l(this.resList.slice(0,this.maxResults),this.cleanResList.slice(0,this.maxResults),this.dataAttribute)}},{key:"searchInputValidation",value:function(t){var e=this;t.addEventListener("keyup",function(){t.value.length>e.threshold&&" "!==t.value?(c(),e.listMatchedResults(),e.onSelection&&u(e.onSelection)):c()})}},{key:"setPlaceHolder",value:function(){this.placeHolder&&o().setAttribute("placeholder",this.placeHolder)}},{key:"init",value:function(){try{this.dataSrc()&&(this.setPlaceHolder(),this.searchInputValidation(o()))}catch(t){h(t)}}}])&&n(t.prototype,i),a&&n(t,a),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
