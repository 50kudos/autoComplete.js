var a,b;a=this,b=function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function v(e,t){for(var n=document.getElementsByClassName("autoComplete_list"),i=0;i<n.length;i++)e!==n[i]&&e!==t&&n[i].parentNode.removeChild(n[i])}function m(l,u,c){for(var e,t,n,i,d=(e=u.inputField,t=u.listClass,n=u.listContainer,(i=document.createElement("div")).setAttribute("id","autoComplete_list"),i.setAttribute("class",t),i.setAttribute("role","listbox"),i.setAttribute("tabindex","-1"),n&&n(i),e.parentNode.appendChild(i),i),o=function(t){var e,n,i,o,r,a=l[t].match,s=(e=a,n=l[t].value,i=u.itemClass,o=u.itemContent,(r=document.createElement("div")).setAttribute("class",i),r.setAttribute("role","option"),r.innerHTML=e,o&&o(n,r),r);s.addEventListener("click",function(){var e={input:u.rawInputValue,query:u.queryInputValue,results:l,selection:l[t].value};c(e)}),d.appendChild(s)},r=0;r<l.length;r++)o(r)}function n(e){e&&(function(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autoComplete_selected")}(e),C>=e.length&&(C=0),C<0&&(C=e.length-1),e[C].classList.add("autoComplete_selected"))}function y(e){var t=document.getElementById("autoComplete_list");t=t&&t.getElementsByTagName("div"),27===e.keyCode?v(!1,e.target):40===e.keyCode||9===e.keyCode?(e.preventDefault(),C++,n(t)):38===e.keyCode||9===e.keyCode?(e.preventDefault(),C--,n(t)):13===e.keyCode&&(e.preventDefault(),-1<C&&t&&t[C].click())}function o(e,t){Promise.resolve(e).then(function(e){t(e)})}function g(r,a,s){for(var l=[],e=function(i){function e(e){var t=e?o[e]:o;if(t){var n="function"==typeof s.searchEngine?s.searchEngine(r,t):function(e,t,n){var i=t.toLowerCase();if("loose"===n.searchEngineType){e=e.replace(/ /g,"");for(var o=[],r=0,a=0;a<i.length;a++){var s=t[a];r<e.length&&i[a]===e[r]&&(s=n.highlight?'<span class="autoComplete_highlighted">'.concat(s,"</span>"):s,r++),o.push(s)}if(r===e.length)return o.join("")}else{if(i.includes(e))return e=new RegExp("".concat(e),"i").exec(t),n.highlight?t.replace(e,'<span class="autoComplete_highlighted">'.concat(e,"</span>")):t}}(r,t,s);n&&e?l.push({key:e,index:i,match:n,value:o}):n&&!e&&l.push({index:i,match:n,value:o})}}var o=a[i];if(s.key){var t,n=u(s.key);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(e){n.e(e)}finally{n.f()}}else e()},t=0;t<a.length;t++)e(t);return s.sort?l.sort(s.sort).slice(0,s.maxResults):l.slice(0,s.maxResults)}function r(n,i){var o;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){return n.apply(e,t)},i)}}function b(e,t,n){e.dispatchEvent(new CustomEvent(n,{bubbles:!0,detail:t,cancelable:!0}))}var C;return function(){function X(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,X);var t=e.selector,n=void 0===t?"#autoComplete":t,i=e.data,o=i.src,r=i.key,a=i.cache,s=void 0===a||a,l=e.query,u=e.trigger,c=(u=void 0===u?{}:u).event,d=void 0===c?["input"]:c,h=u.condition,f=void 0!==h&&h,p=e.searchEngine,v=void 0===p?"strict":p,m=e.threshold,y=void 0===m?0:m,g=e.debounce,b=void 0===g?0:g,C=e.resultsList,k=(C=void 0===C?{}:C).render,E=void 0===k||k,L=C.container,w=void 0!==L&&L,x=C.destination,F=C.position,S=void 0===F?"afterend":F,A=C.element,I=void 0===A?"ul":A,_=C.className,q=void 0===_?"autoComplete_list":_,T=C.navigation,H=void 0!==T&&T,N=e.sort,R=void 0!==N&&N,j=e.placeHolder,M=e.maxResults,J=void 0===M?5:M,O=e.resultItem,V=(O=void 0===O?{}:O).content,B=void 0!==V&&V,D=O.element,P=void 0===D?"li":D,U=O.className,$=void 0===U?"autoComplete_result":U,z=e.noResults,G=e.highlight,K=void 0!==G&&G,Q=e.feedback,W=e.onSelection;this.inputField=n,this.data={src:function(){return"function"==typeof o?o():o},key:r,cache:s},this.query=l,this.trigger={event:d,condition:f},this.searchEngine=v,this.threshold=y,this.debounce=b,this.resultsList={render:E,container:w,destination:x||this.inputField,position:S,element:I,className:q,navigation:H},this.sort=R,this.placeHolder=j,this.maxResults=J,this.resultItem={content:B,element:P,className:$},this.noResults=z,this.highlight=K,this.feedback=Q,this.onSelection=W,this.preInit()}var e,t,n;return e=X,(t=[{key:"run",value:function(e,t,n){v(!1,t);var i,o,r,a,s,l,u=(i=t)instanceof HTMLInputElement||i instanceof HTMLTextAreaElement?i.value.toLowerCase():i.innerHTML.toLowerCase(),c=(o=u,(r=this.query)&&r.manipulate?r.manipulate(o):o);if(a=this.trigger,s=c,l=this.threshold,a.condition?a.condition(s):s.length>=l&&s.replace(/ /g,"").length){b(this.inputField,n,"autoCompleteJS_request");var d={searchEngine:this.searchEngine,highlight:this.highlight,key:this.data.key,sort:this.sort,maxResults:this.maxResults},h=g(c,n,d);if(b(t,{input:u,query:c,results:h},"autoCompleteJS_response"),!n.length)return this.noResults();var f={input:u,query:c,results:h};if(!this.resultsList.render)return this.feedback(e,f);var p={inputField:t,rawInputValue:u,queryInputValue:c,listClass:this.resultsList.className,itemClass:this.resultItem.className,listContainer:this.resultsList.container,itemContent:this.resultItem.content};m(h,p,this.onSelection),C=-1,t.addEventListener("keydown",y),document.addEventListener("click",function(e){return v(e.target,t)})}}},{key:"init",value:function(){var n=this;this.data.cache?o(this.data.src(),function(t){n.placeHolder&&n.inputField.setAttribute("placeholder",n.placeHolder),n.inputField.addEventListener("input",r(function(e){n.run(e,n.inputField,t)},n.debounce))}):(this.placeHolder&&this.inputField.setAttribute("placeholder",this.placeHolder),this.inputField.addEventListener("input",r(function(t){o(n.data.src(),function(e){n.run(t,n.inputField,e)})},this.debounce))),b(this.inputField,null,"autoCompleteJS_init")}},{key:"preInit",value:function(){var r=this,a=document;new MutationObserver(function(e,t){var n,i=u(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.querySelector(r.inputField)&&(t.disconnect(),r.inputField=a.querySelector(r.inputField),b(r.inputField,{mutation:o},"autoCompleteJS_connect"),r.init())}}catch(e){i.e(e)}finally{i.f()}}).observe(a,{childList:!0,subtree:!0})}}])&&i(e.prototype,t),n&&i(e,n),X}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoCompleteJS=b();
