var a,b;a=this,b=function(){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r,a="data-result",t="autoComplete_results_list",c="autoComplete_result",n="autoComplete_highlighted",u=function(e){return"string"==typeof e?document.querySelector(e):e()},l=function(){return r.innerHTML=""},h=u,s=function(e){(r=document.createElement("ul")).setAttribute("id",t),e.destination.insertAdjacentElement(e.position,r)},d=function(e){return"<span class=".concat(n,">").concat(e,"</span>")},f=function(o,s){o.forEach(function(e,t){var n=document.createElement("li"),i=o[t].source[s]||o[t].source;n.setAttribute(a,i),n.setAttribute("class",c),n.setAttribute("tabindex","1"),n.innerHTML=o[t].match||o[t],r.appendChild(n)})},p=function(e){var n=u(e),i=r.firstChild;document.onkeydown=function(e){var t=document.activeElement;switch(e.keyCode){case 38:t!==i&&t!==n?t.previousSibling.focus():t===i&&n.focus();break;case 40:t===n&&0<r.childNodes.length?i.focus():t!==r.lastChild&&t.nextSibling.focus()}}},v=l,g=function(n,i,o,s){r.querySelectorAll(".".concat(c)).forEach(function(t){["mousedown","keydown"].forEach(function(e){t.addEventListener(e,function(t){"mousedown"!==e&&13!==t.keyCode||(i({event:t,query:u(n).value,results:o.map(function(e){return e.source}),selection:o.find(function(e){return(e.source[s]||e.source)===t.target.closest(".".concat(c)).getAttribute(a)}).source}),l())})})})};return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e.selector||"#autoComplete",this.data={src:function(){return"function"==typeof e.data.src?e.data.src():e.data.src},key:e.data.key},this.searchEngine="loose"===e.searchEngine?"loose":"strict",this.threshold=e.threshold||0,this.renderResults=s({destination:e.renderResults?e.renderResults.destination:h(this.selector),position:e.renderResults?e.renderResults.position:"afterend"}),this.placeHolder=e.placeHolder,this.maxResults=e.maxResults||5,this.highlight=e.highlight||!1,this.onSelection=e.onSelection,this.init()}var e,n,i;return e=t,(n=[{key:"search",value:function(e,t){var n=this.highlight,i=t.toLowerCase();if("loose"===this.searchEngine){e=e.replace(/ /g,"");for(var o=[],s=0,r=0;r<i.length;r++){var a=i[r];s<e.length&&a===e[s]&&(a=n?d(a):a,s++),o.push(a)}return s===e.length&&o.join("")}if(i.includes(e)&&n){var c=h(this.selector).value.toLowerCase();return i.replace(c,d(c))}}},{key:"listMatchedResults",value:function(e){var n=this,i=[],o=h(this.selector).value.toLowerCase();e.filter(function(e){var t=n.search(o,e[n.data.key]||e);t&&i.push({match:t,source:e})});var t=i.slice(0,this.maxResults);return f(t,this.data.key),p(this.selector),t}},{key:"ignite",value:function(t){var n=this,i=this.selector,o=h(i),e=this.placeHolder,s=this.onSelection;e&&o.setAttribute("placeholder",e),o.onkeyup=function(){v();if(o.value.length>n.threshold&&o.value.replace(/ /g,"").length){var e=n.listMatchedResults(t);s&&g(i,s,e,n.data.key)}}}},{key:"init",value:function(){var t=this,e=this.data.src();e instanceof Promise?e.then(function(e){return t.ignite(e)}):this.ignite(e)}}])&&o(e.prototype,n),i&&o(e,i),t}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
