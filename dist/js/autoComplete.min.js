var a,b;a=this,b=function(){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function c(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function m(t,e){for(var i=document.getElementsByClassName("autoComplete_list"),n=0;n<i.length;n++)t!==i[n]&&t!==e&&i[n].parentNode.removeChild(i[n])}function v(u,c,d){for(var t,e,i,h=(t=c.inputField,e=c,(i=document.createElement("div")).setAttribute("id",e.listId),i.setAttribute("aria-expanded",!0),i.setAttribute("aria-labelledby",e.listId),i.setAttribute("class",e.listClass),i.setAttribute("role","listbox"),i.setAttribute("tabindex","-1"),e.container&&container(i),t.parentNode.appendChild(i),i),n=function(e){var t,i,n,r,o,a,s=u[e].match,l=(t=s,i=u[e].value,n=e,r=c.itemClass,o=c.itemContent,(a=document.createElement("div")).setAttribute("id","".concat(r,"_").concat(n)),a.setAttribute("class",r),a.setAttribute("role","option"),a.innerHTML=t,o&&o(i,a),a);l.addEventListener("click",function(){var t={input:c.rawInputValue,query:c.queryInputValue,results:u,selection:u[e].value};d(t)}),h.appendChild(l)},r=0;r<u.length;r++)n(r);return h}function i(t){t&&(function(t){for(var e=0;e<t.length;e++)t[e].removeAttribute("aria-selected"),t[e].classList.remove("autoComplete_selected")}(t),C>=t.length&&(C=0),C<0&&(C=t.length-1),t[C].setAttribute("aria-selected","true"),t[C].classList.add("autoComplete_selected"))}function b(t){var e=document.getElementById("autoComplete_list");e=e&&e.getElementsByTagName("div"),27===t.keyCode?m(!1,t.target):40===t.keyCode||9===t.keyCode?(t.preventDefault(),C++,i(e)):38===t.keyCode||9===t.keyCode?(t.preventDefault(),C--,i(e)):13===t.keyCode&&(t.preventDefault(),-1<C&&e&&e[C].click())}function r(t,e){Promise.resolve(t).then(function(t){e(t)})}function y(o,a,s){for(var l=[],t=function(n){function t(t){var e=t?r[t]:r;if(e){var i="function"==typeof s.searchEngine?s.searchEngine(o,e):function(t,e,i){var n=e.toLowerCase();if("loose"===i.searchEngine){t=t.replace(/ /g,"");for(var r=[],o=0,a=0;a<n.length;a++){var s=e[a];o<t.length&&n[a]===t[o]&&(s=i.highlight?'<span class="autoComplete_highlighted">'.concat(s,"</span>"):s,o++),r.push(s)}if(o===t.length)return r.join("")}else{if(n.includes(t))return t=new RegExp("".concat(t),"i").exec(e),i.highlight?e.replace(t,'<span class="autoComplete_highlighted">'.concat(t,"</span>")):e}}(o,e,s);i&&t?l.push({key:t,index:n,match:i,value:r}):i&&!t&&l.push({index:n,match:i,value:r})}}var r=a[n];if(s.key){var e,i=c(s.key);try{for(i.s();!(e=i.n()).done;){t(e.value)}}catch(t){i.e(t)}finally{i.f()}}else t()},e=0;e<a.length;e++)t(e);return s.sort?l.sort(s.sort).slice(0,s.maxResults):l.slice(0,s.maxResults)}function o(i,n){var r;return function(){var t=this,e=arguments;clearTimeout(r),r=setTimeout(function(){return i.apply(t,e)},n)}}function g(t,e,i){t.dispatchEvent(new CustomEvent(i,{bubbles:!0,detail:e,cancelable:!0}))}var C;return function(){function nt(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,nt);var e=t.name,i=void 0===e?"Search":e,n=t.selector,r=void 0===n?"#autoComplete":n,o=t.data,a=o.src,s=o.key,l=o.cache,u=void 0===l||l,c=t.query,d=t.trigger,h=(d=void 0===d?{}:d).event,p=void 0===h?["input"]:h,f=d.condition,m=void 0!==f&&f,v=t.searchEngine,b=void 0===v?"strict":v,y=t.threshold,g=void 0===y?0:y,C=t.debounce,A=void 0===C?0:C,k=t.resultsList,I=(k=void 0===k?{}:k).render,E=void 0===I||I,L=k.container,N=void 0!==L&&L,x=k.destination,w=k.position,F=void 0===w?"afterend":w,S=k.element,_=void 0===S?"ul":S,q=k.idName,H=void 0===q?"autoComplete_list":q,R=k.className,T=void 0===R?"autoComplete_list":R,j=k.navigation,M=void 0!==j&&j,J=t.sort,O=void 0!==J&&J,V=t.placeHolder,B=t.maxResults,D=void 0===B?5:B,P=t.resultItem,z=(P=void 0===P?{}:P).content,U=void 0!==z&&z,$=P.element,G=void 0===$?"li":$,K=P.idName,Q=void 0===K?"autoComplete_result":K,W=P.className,X=void 0===W?"autoComplete_result":W,Y=t.noResults,Z=t.highlight,tt=void 0!==Z&&Z,et=t.feedback,it=t.onSelection;this.name=i,this.inputField=r,this.data={src:function(){return"function"==typeof a?a():a},key:s,cache:u},this.query=c,this.trigger={event:p,condition:m},this.searchEngine=b,this.threshold=g,this.debounce=A,this.resultsList={render:E,container:N,destination:x||this.inputField,position:F,element:_,idName:H,className:T,navigation:M},this.sort=O,this.placeHolder=V,this.maxResults=D,this.resultItem={content:U,element:G,idName:Q,className:X},this.noResults=Y,this.highlight=tt,this.feedback=et,this.onSelection=it,this.preInit()}var t,e,i;return t=nt,(e=[{key:"run",value:function(t,e,i){m(!1,e);var n,r,o,a,s,l,u=(n=e)instanceof HTMLInputElement||n instanceof HTMLTextAreaElement?n.value.toLowerCase():n.innerHTML.toLowerCase(),c=(r=u,(o=this.query)&&o.manipulate?o.manipulate(r):r);if(a=this.trigger,s=c,l=this.threshold,a.condition?a.condition(s):s.length>=l&&s.replace(/ /g,"").length){g(this.inputField,i,"autoCompleteJS_request");var d={searchEngine:this.searchEngine,highlight:this.highlight,key:this.data.key,sort:this.sort,maxResults:this.maxResults},h=y(c,i,d);if(g(e,{input:u,query:c,results:h},"autoCompleteJS_response"),!i.length)return this.noResults();var p={input:u,query:c,results:h};if(!this.resultsList.render)return this.feedback(t,p);var f={inputField:e,rawInputValue:u,queryInputValue:c,listId:this.resultsList.idName,listClass:this.resultsList.className,itemId:this.resultItem.idName,itemClass:this.resultItem.className,listContainer:this.resultsList.container,itemContent:this.resultItem.content};v(h,f,this.onSelection);!function(t,e){C=-1;var i=e||b;t.addEventListener("keydown",i)}(e,this.resultsList.navigation),document.addEventListener("click",function(t){return m(t.target,e)})}}},{key:"init",value:function(){var i=this;this.data.cache?r(this.data.src(),function(e){i.placeHolder&&i.inputField.setAttribute("placeholder",i.placeHolder),i.inputField.addEventListener("input",o(function(t){i.run(t,i.inputField,e)},i.debounce))}):(this.placeHolder&&this.inputField.setAttribute("placeholder",this.placeHolder),this.inputField.addEventListener("input",o(function(e){r(i.data.src(),function(t){i.run(e,i.inputField,t)})},this.debounce))),g(this.inputField,null,"autoCompleteJS_init")}},{key:"preInit",value:function(){var l=this,u=document;new MutationObserver(function(t,e){var i,n,r,o=c(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(u.querySelector(l.inputField)){e.disconnect(),l.inputField=u.querySelector(l.inputField);var s={inputName:l.name,listId:l.resultsList.idName,listClass:l.resultsList.className,itemId:l.resultItem.idName,itemClass:l.resultItem.className};n=l.inputField,r=s,n.setAttribute("dir","ltr"),n.setAttribute("type","text"),n.setAttribute("spellcheck",!1),n.setAttribute("autocorrect","off"),n.setAttribute("autocomplete","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("title",r.inputName),n.setAttribute("role","combobox"),n.setAttribute("aria-label",r.inputName),n.setAttribute("aria-owns",r.listId),n.setAttribute("aria-haspopup",!0),n.setAttribute("aria-autocomplete","both"),g(l.inputField,{mutation:a},"autoCompleteJS_connect"),l.init()}}}catch(t){o.e(t)}finally{o.f()}}).observe(u,{childList:!0,subtree:!0})}}])&&n(t.prototype,e),i&&n(t,i),nt}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoCompleteJS=b();
