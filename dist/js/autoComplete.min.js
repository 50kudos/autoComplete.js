var a,b;a=this,b=function(){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function u(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function c(e,t){for(var i=document.getElementsByClassName("autoComplete_list"),n=0;n<i.length;n++)e!==i[n]&&e!==t&&i[n].parentNode.removeChild(i[n])}function o(s,l){for(var e,t,u=(e=s,(t=document.createElement("div")).setAttribute("id",e.resultsList.idName),t.setAttribute("aria-expanded",!0),t.setAttribute("aria-labelledby",e.resultsList.idName),t.setAttribute("class",e.resultsList.className),t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1"),e.resultsList.container&&e.resultsList.container(t),e.inputField.parentNode.appendChild(t),t),i=function(t){var e,i,n,r,o,a=l.results[t].match,a=(e=a,i=l.results[t].value,n=t,r=s.resultItem.className,o=s.resultItem.content,(a=document.createElement("div")).setAttribute("id","".concat(r,"_").concat(n)),a.setAttribute("aria-selected","false"),a.setAttribute("class",r),a.setAttribute("role","option"),a.innerHTML=e,o&&o(i,a),a);a.addEventListener("click",function(){var e={input:l.input,query:l.query,results:l.results,selection:l.results[t].value};s.onSelection(e)}),u.appendChild(a)},n=0;n<l.results.length;n++)i(n);return u}function d(e,t,i){e.dispatchEvent(new CustomEvent(i,{bubbles:!0,detail:t,cancelable:!0}))}function i(e){e&&(function(e){for(var t=0;t<e.length;t++)e[t].setAttribute("aria-selected","false"),e[t].classList.remove("autoComplete_selected")}(e),h>=e.length&&(h=0),h<0&&(h=e.length-1),e[h].setAttribute("aria-selected","true"),e[h].classList.add("autoComplete_selected"))}function a(e){var t;e.target.value.trim()&&(t=(t=document.getElementById("autoComplete_list"))&&t.getElementsByTagName("div"),27===e.keyCode?c(!1,e.target):40===e.keyCode||9===e.keyCode?(e.preventDefault(),h++,i(t)):38===e.keyCode||9===e.keyCode?(e.preventDefault(),h--,i(t)):13===e.keyCode&&(e.preventDefault(),-1<h&&t&&t[h].click()),d(e.srcElement,{selection:t[h],event:e},"navigation"))}function l(o,a,s){for(var l=[],e=function(i){function e(e){var t=e?n[e]:n;t&&((t="function"==typeof o.searchEngine?o.searchEngine(a,t):function(e,t,i){var n=t.toLowerCase();if("loose"===i.searchEngine){e=e.replace(/ /g,"");for(var r=[],o=0,a=0;a<n.length;a++){var s=t[a];o<e.length&&n[a]===e[o]&&(s=i.highlight?'<span class="autoComplete_highlighted">'.concat(s,"</span>"):s,o++),r.push(s)}if(o===e.length)return r.join("")}else if(n.includes(e))return e=new RegExp("".concat(e),"i").exec(t),i.highlight?t.replace(e,'<span class="autoComplete_highlighted">'.concat(e,"</span>")):t}(a,t,o))&&e?l.push({key:e,index:i,match:t,value:n}):t&&!e&&l.push({index:i,match:t,value:n}))}var n=s[i];if(o.data.key){var t,r=u(o.data.key);try{for(r.s();!(t=r.n()).done;)e(t.value)}catch(e){r.e(e)}finally{r.f()}}else e()},t=0;t<s.length;t++)e(t);return(o.sort?l.sort(o.sort):l).slice(0,o.maxResults)}var h;return function(){function S(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S);var t=e.name,i=void 0===t?"Search":t,n=e.selector,r=void 0===n?"#autoComplete":n,o=e.data,a=o.src,s=o.key,l=o.cache,u=void 0===l||l,c=e.query,d=e.trigger,h=(d=void 0===d?{}:d).event,p=void 0===h?["input"]:h,f=d.condition,v=void 0!==f&&f,m=e.searchEngine,b=void 0===m?"strict":m,y=e.threshold,g=void 0===y?0:y,A=e.debounce,k=void 0===A?0:A,F=e.resultsList,C=(F=void 0===F?{}:F).render,E=void 0===C||C,L=F.container,N=void 0!==L&&L,w=F.destination,x=F.position,I=void 0===x?"afterend":x,t=F.element,n=void 0===t?"ul":t,o=F.idName,l=void 0===o?"autoComplete_list":o,h=F.className,d=void 0===h?"autoComplete_list":h,f=F.navigation,m=void 0!==f&&f,y=e.sort,A=void 0!==y&&y,C=e.placeHolder,L=e.maxResults,x=void 0===L?5:L,t=e.resultItem,o=(t=void 0===t?{}:t).content,h=void 0!==o&&o,F=t.element,f=void 0===F?"li":F,y=t.idName,L=void 0===y?"autoComplete_result":y,o=t.className,F=void 0===o?"autoComplete_result":o,y=e.noResults,t=e.highlight,o=void 0!==t&&t,t=e.feedback,e=e.onSelection;this.name=i,this.selector=r,this.data={src:function(){return"function"==typeof a?a():a},key:s,cache:u},this.query=c,this.trigger={event:p,condition:v},this.searchEngine=b,this.threshold=g,this.debounce=k,this.resultsList={render:E,container:N,destination:w||this.inputField,position:I,element:n,idName:l,className:d,navigation:m},this.sort=A,this.placeHolder=C,this.maxResults=x,this.resultItem={content:h,element:f,idName:L,className:F},this.noResults=y,this.highlight=o,this.feedback=t,this.onSelection=e,this.preInit()}var e,t,i;return e=S,(t=[{key:"start",value:function(e,t,i){var n=this,r=l(this,i,e),i={input:t,query:i,results:r};if(d(this.inputField,i,"response"),!e.length)return this.noResults();if(!this.resultsList.render)return this.feedback(i);r.length&&o(this,i);d(this.inputField,i,"rendered"),function(e){h=-1;var t=e.resultsList.navigation||a;e.inputField.addEventListener("keydown",t)}(this),document.addEventListener("click",function(e){return c(e.target,n.inputField)})}},{key:"compose",value:function(){var u=this;return new Promise(function(e,t){var i,n,r,o,a,s;return r=u.inputField,i=(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement?r.value:r.innerHTML).toLowerCase(),a=i,o=u.query,n=o&&o.manipulate?o.manipulate(a):a,r=u.trigger,o=n,a=u.threshold,(r.condition?r.condition(o):o.length>=a&&o.replace(/ /g,"").length)?u.data.src().then(function(e){try{return s=e,d(u.inputField,s,"request"),c(!1,u.inputField),u.start(s,i,n),l.call(u)}catch(e){return t(e)}},t):(c(!1,u.inputField),l.call(u));function l(){return e()}})}},{key:"init",value:function(){var i,n,r,t=this;this.placeHolder&&this.inputField.setAttribute("placeholder",this.placeHolder),this.hook=(i=function(e){t.compose(e)},n=this.debounce,function(){var e=this,t=arguments;clearTimeout(r),r=setTimeout(function(){return i.apply(e,t)},n)}),this.inputField.addEventListener("input",this.hook),d(this.inputField,null,"init")}},{key:"preInit",value:function(){var o=this,a=document;new MutationObserver(function(e,t){var i,n=u(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;a.querySelector(o.selector)&&(t.disconnect(),o.inputField=a.querySelector(o.selector),(i=o).inputField.setAttribute("dir","ltr"),i.inputField.setAttribute("type","text"),i.inputField.setAttribute("spellcheck",!1),i.inputField.setAttribute("autocorrect","off"),i.inputField.setAttribute("autocomplete","off"),i.inputField.setAttribute("autocapitalize","off"),i.inputField.setAttribute("title",i.name),i.inputField.setAttribute("aria-label",i.inputName),i.inputField.setAttribute("aria-owns",i.resultItem.idName),i.inputField.setAttribute("aria-haspopup",!0),i.inputField.setAttribute("aria-autocomplete","both"),d(o.inputField,{mutation:r},"connect"),o.init())}}catch(e){n.e(e)}finally{n.f()}}).observe(a,{childList:!0,subtree:!0})}},{key:"unInit",value:function(){this.inputField.removeEventListener("input",this.hook),d(this.inputField,null,"unInit")}}])&&n(e.prototype,t),i&&n(e,i),S}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a="undefined"!=typeof globalThis?globalThis:a||self).autoCompleteJS=b();
