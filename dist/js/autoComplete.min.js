var a,b;a=this,b=function(){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o,a=function(t){return document.querySelector(t)},u=function(){return o.innerHTML=""},c=a,s=function(t){(o=document.createElement("ul")).setAttribute("id","autoComplete_results_list"),t.destination.insertAdjacentElement(t.position,o)},l=function(t){return'<span class="autoComplete_highlighted">'.concat(t,"</span>")},h=function(r,s,a){r.forEach(function(t,e){var n=document.createElement("li"),i=r[e].source[s]||r[e].source;n.setAttribute("data-".concat(a.tag),a.value||i),n.setAttribute("id",i),n.setAttribute("class","autoComplete_result"),n.innerHTML=r[e].match||r[e],o.appendChild(n)})},d=function(n,i,r,s){document.querySelectorAll(".autoComplete_result").forEach(function(t){t.addEventListener("mousedown",function(e){i({query:a(n).value,results:r.map(function(t){return t.source}),selection:r.find(function(t){return(t.source[s]||t.source)===e.target.closest(".autoComplete_result").id}).source}),a(n).value="",u()})})},f=u,p=function(t){document.querySelector("body").innerHTML='<div class="autoComplete_error">'.concat(t,"</div>")};return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=t.threshold||0,this.renderResults=s({destination:t.renderResults?t.renderResults.destination:c(this.selector),position:t.renderResults?t.renderResults.position:"afterend"}),this.placeHolder=t.placeHolder||"",this.maxResults=t.maxResults||5,this.highlight=t.highlight||!1,this.dataAttribute={tag:t.dataAttribute?t.dataAttribute.tag:"autocomplete",value:t.dataAttribute?t.dataAttribute.value:""},this.onSelection=t.onSelection,this.init()}var t,n,i;return t=e,(n=[{key:"search",value:function(t,e){var n=e.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var i=[],r=0,s=0;s<n.length;s++){var a=n[s];r<t.length&&a===t[r]&&(a=this.highlight?l(a):a,r++),i.push(a)}return r===t.length&&i.join("")}if(n.includes(t)){if(this.highlight){var o=c(this.selector).value.toLowerCase();return n.replace(o,l(o))}return n}}},{key:"listMatchedResults",value:function(t){var n=this;this.resList=[];var i=c(this.selector).value.toLowerCase();t.filter(function(t){var e=n.search(i,t[n.data.key]||t);e&&n.resList.push({match:e,source:t})});var e=this.resList.slice(0,this.maxResults);return h(e,this.data.key,this.dataAttribute),e}},{key:"ignite",value:function(e){var n=this;if(this.data.src()){c(this.selector).setAttribute("placeholder",this.placeHolder);var i=c(this.selector);i.addEventListener("keyup",function(){if(i.value.length>n.threshold&&" "!==i.value){f();var t=n.listMatchedResults(e);n.onSelection&&d(n.selector,n.onSelection,t,n.data.key)}else f()})}}},{key:"init",value:function(){var e=this;try{return this.data.src()instanceof Promise?this.data.src().then(function(t){return e.ignite(t)}):this.ignite(this.data.src())}catch(t){p(t)}}}])&&r(t.prototype,n),i&&r(t,i),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
