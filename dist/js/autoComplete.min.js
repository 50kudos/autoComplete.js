var a,b;a=this,b=function(){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var a,u="data-result",c={resultsList:"autoComplete_results_list",result:"autoComplete_result",highlight:"autoComplete_highlighted"},r=function(t){return"string"==typeof t?document.querySelector(t):t()},l=function(){return a.innerHTML=""},h=r,o=function(t){a=document.createElement("ul"),t.container&&(c.resultsList=t.container(a)||c.resultsList),a.setAttribute("id",c.resultsList),t.destination.insertAdjacentElement(t.position,a)},f=function(t){return"<span class=".concat(c.highlight,">").concat(t,"</span>")},d=function(i,o,r){i.forEach(function(t,e){var n=document.createElement("li"),s=i[e].source[o]||i[e].source;n.setAttribute(u,s),n.setAttribute("class",c.result),n.setAttribute("tabindex","1"),n.innerHTML=r?r(t,n):t.match||t,a.appendChild(n)})},p=function(t){var n=r(t),s=a.firstChild;document.onkeydown=function(t){var e=document.activeElement;switch(t.keyCode){case 38:e!==s&&e!==n?e.previousSibling.focus():e===s&&n.focus();break;case 40:e===n&&0<a.childNodes.length?s.focus():e!==a.lastChild&&e.nextSibling.focus()}}},g=l,v=function(n,s,i,o){a.querySelectorAll(".".concat(c.result)).forEach(function(e){["mousedown","keydown"].forEach(function(t){e.addEventListener(t,function(e){"mousedown"!==t&&13!==e.keyCode||(s({event:e,query:r(n).value,results:i.map(function(t){return t.source}),selection:i.find(function(t){return(t.source[o]||t.source)===e.target.closest(".".concat(c.result)).getAttribute(u)}).source}),l())})})})};return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=t.threshold||0,this.resultsList=o({container:t.resultsList.container,destination:t.resultsList.destination?t.resultsList.destination:h(this.selector),position:t.resultsList.position?t.resultsList.position:"afterend"}),this.placeHolder=t.placeHolder,this.maxResults=t.maxResults||5,this.resultItem=t.resultItem,this.highlight=t.highlight||!1,this.onSelection=t.onSelection,this.init()}var t,n,s;return t=e,(n=[{key:"search",value:function(t,e){var n=this.highlight,s=e.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var i=[],o=0,r=0;r<s.length;r++){var a=s[r];o<t.length&&a===t[o]&&(a=n?f(a):a,o++),i.push(a)}return o===t.length&&i.join("")}if(s.includes(t)&&n){var u=h(this.selector).value.toLowerCase();return s.replace(u,f(u))}}},{key:"listMatchedResults",value:function(t){var n=this,s=[],i=h(this.selector).value.toLowerCase();t.filter(function(t){var e=n.search(i,t[n.data.key]||t);e&&s.push({match:e,source:t})});var e=s.slice(0,this.maxResults);return d(e,this.data.key,this.resultItem),p(this.selector),e}},{key:"ignite",value:function(e){var n=this,s=this.selector,i=h(s),t=this.placeHolder,o=this.onSelection;t&&i.setAttribute("placeholder",t),i.onkeyup=function(){g();if(i.value.length>n.threshold&&i.value.replace(/ /g,"").length){var t=n.listMatchedResults(e);o&&v(s,o,t,n.data.key)}}}},{key:"init",value:function(){var e=this,t=this.data.src();t instanceof Promise?t.then(function(t){return e.ignite(t)}):this.ignite(t)}}])&&i(t.prototype,n),s&&i(t,s),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
