var a,b;a=this,b=function(){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a,u="data-result",t="autoComplete_results_list",c="autoComplete_result",n="autoComplete_highlighted",r=function(e){return"string"==typeof e?document.querySelector(e):e()},l=function(){return a.innerHTML=""},h=r,o=function(e){(a=document.createElement("ul")).setAttribute("id",t),e.destination.insertAdjacentElement(e.position,a)},f=function(e){return"<span class=".concat(n,">").concat(e,"</span>")},d=function(s,o,r){s.forEach(function(e,t){var n=document.createElement("li"),i=s[t].source[o]||s[t].source;n.setAttribute(u,i),n.setAttribute("class",c),n.setAttribute("tabindex","1"),n.innerHTML=r?r(e,n):e.match||e,a.appendChild(n)})},p=function(e){var n=r(e),i=a.firstChild;document.onkeydown=function(e){var t=document.activeElement;switch(e.keyCode){case 38:t!==i&&t!==n?t.previousSibling.focus():t===i&&n.focus();break;case 40:t===n&&0<a.childNodes.length?i.focus():t!==a.lastChild&&t.nextSibling.focus()}}},v=l,m=function(n,i,s,o){a.querySelectorAll(".".concat(c)).forEach(function(t){["mousedown","keydown"].forEach(function(e){t.addEventListener(e,function(t){"mousedown"!==e&&13!==t.keyCode||(i({event:t,query:r(n).value,results:s.map(function(e){return e.source}),selection:s.find(function(e){return(e.source[o]||e.source)===t.target.closest(".".concat(c)).getAttribute(u)}).source}),l())})})})};return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e.selector||"#autoComplete",this.data={src:function(){return"function"==typeof e.data.src?e.data.src():e.data.src},key:e.data.key},this.searchEngine="loose"===e.searchEngine?"loose":"strict",this.threshold=e.threshold||0,this.resultsList=o({destination:e.resultsList?e.resultsList.destination:h(this.selector),position:e.resultsList?e.resultsList.position:"afterend"}),this.placeHolder=e.placeHolder,this.maxResults=e.maxResults||5,this.resultItem=e.resultItem,this.highlight=e.highlight||!1,this.onSelection=e.onSelection,this.init()}var e,n,i;return e=t,(n=[{key:"search",value:function(e,t){var n=this.highlight,i=t.toLowerCase();if("loose"===this.searchEngine){e=e.replace(/ /g,"");for(var s=[],o=0,r=0;r<i.length;r++){var a=i[r];o<e.length&&a===e[o]&&(a=n?f(a):a,o++),s.push(a)}return o===e.length&&s.join("")}if(i.includes(e)&&n){var u=h(this.selector).value.toLowerCase();return i.replace(u,f(u))}}},{key:"listMatchedResults",value:function(e){var n=this,i=[],s=h(this.selector).value.toLowerCase();e.filter(function(e){var t=n.search(s,e[n.data.key]||e);t&&i.push({match:t,source:e})});var t=i.slice(0,this.maxResults);return d(t,this.data.key,this.resultItem),p(this.selector),t}},{key:"ignite",value:function(t){var n=this,i=this.selector,s=h(i),e=this.placeHolder,o=this.onSelection;e&&s.setAttribute("placeholder",e),s.onkeyup=function(){v();if(s.value.length>n.threshold&&s.value.replace(/ /g,"").length){var e=n.listMatchedResults(t);o&&m(i,o,e,n.data.key)}}}},{key:"init",value:function(){var t=this,e=this.data.src();e instanceof Promise?e.then(function(e){return t.ignite(e)}):this.ignite(e)}}])&&s(e.prototype,n),i&&s(e,i),t}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
