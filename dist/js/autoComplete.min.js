var a,b;a=this,b=function(){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function c(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return l(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,s=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw s}}}}function m(e,t){for(var i=document.getElementsByClassName("autoComplete_list"),n=0;n<i.length;n++)e!==i[n]&&e!==t&&i[n].parentNode.removeChild(i[n])}function v(u,c,d){for(var e,t,i,h=(e=c.inputField,t=c,(i=document.createElement("div")).setAttribute("id",t.listId),i.setAttribute("aria-expanded",!0),i.setAttribute("aria-labelledby",t.listId),i.setAttribute("class",t.listClass),i.setAttribute("role","listbox"),i.setAttribute("tabindex","-1"),t.container&&container(i),e.parentNode.appendChild(i),i),n=function(t){var e,i,n,r,s,a,o=u[t].match,l=(e=o,i=u[t].value,n=t,r=c.itemClass,s=c.itemContent,(a=document.createElement("div")).setAttribute("id","".concat(r,"_").concat(n)),a.setAttribute("aria-selected","false"),a.setAttribute("class",r),a.setAttribute("role","option"),a.innerHTML=e,s&&s(i,a),a);l.addEventListener("click",function(){var e={input:c.rawInputValue,query:c.queryInputValue,results:u,selection:u[t].value};d(e)}),h.appendChild(l)},r=0;r<u.length;r++)n(r);return h}function b(e,t,i){e.dispatchEvent(new CustomEvent(i,{bubbles:!0,detail:t,cancelable:!0}))}function i(e){e&&(function(e){for(var t=0;t<e.length;t++)e[t].setAttribute("aria-selected","false"),e[t].classList.remove("autoComplete_selected")}(e),C>=e.length&&(C=0),C<0&&(C=e.length-1),e[C].setAttribute("aria-selected","true"),e[C].classList.add("autoComplete_selected"))}function y(e){var t=document.getElementById("autoComplete_list");t=t&&t.getElementsByTagName("div"),27===e.keyCode?m(!1,e.target):40===e.keyCode||9===e.keyCode?(e.preventDefault(),C++,i(t)):38===e.keyCode||9===e.keyCode?(e.preventDefault(),C--,i(t)):13===e.keyCode&&(e.preventDefault(),-1<C&&t&&t[C].click()),b(e.srcElement,{selection:t[C],event:e},"navigation")}function r(e,t){Promise.resolve(e).then(function(e){t(e)})}function g(s,a,o){for(var l=[],e=function(n){function e(e){var t=e?r[e]:r;if(t){var i="function"==typeof o.searchEngine?o.searchEngine(s,t):function(e,t,i){var n=t.toLowerCase();if("loose"===i.searchEngine){e=e.replace(/ /g,"");for(var r=[],s=0,a=0;a<n.length;a++){var o=t[a];s<e.length&&n[a]===e[s]&&(o=i.highlight?'<span class="autoComplete_highlighted">'.concat(o,"</span>"):o,s++),r.push(o)}if(s===e.length)return r.join("")}else{if(n.includes(e))return e=new RegExp("".concat(e),"i").exec(t),i.highlight?t.replace(e,'<span class="autoComplete_highlighted">'.concat(e,"</span>")):t}}(s,t,o);i&&e?l.push({key:e,index:n,match:i,value:r}):i&&!e&&l.push({index:n,match:i,value:r})}}var r=a[n];if(o.key){var t,i=c(o.key);try{for(i.s();!(t=i.n()).done;){e(t.value)}}catch(e){i.e(e)}finally{i.f()}}else e()},t=0;t<a.length;t++)e(t);return o.sort?l.sort(o.sort).slice(0,o.maxResults):l.slice(0,o.maxResults)}function s(i,n){var r;return function(){var e=this,t=arguments;clearTimeout(r),r=setTimeout(function(){return i.apply(e,t)},n)}}var C;return function(){function ne(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ne);var t=e.name,i=void 0===t?"Search":t,n=e.selector,r=void 0===n?"#autoComplete":n,s=e.data,a=s.src,o=s.key,l=s.cache,u=void 0===l||l,c=e.query,d=e.trigger,h=(d=void 0===d?{}:d).event,f=void 0===h?["input"]:h,p=d.condition,m=void 0!==p&&p,v=e.searchEngine,b=void 0===v?"strict":v,y=e.threshold,g=void 0===y?0:y,C=e.debounce,A=void 0===C?0:C,k=e.resultsList,E=(k=void 0===k?{}:k).render,I=void 0===E||E,L=k.container,x=void 0!==L&&L,N=k.destination,w=k.position,F=void 0===w?"afterend":w,q=k.element,S=void 0===q?"ul":q,_=k.idName,H=void 0===_?"autoComplete_list":_,R=k.className,T=void 0===R?"autoComplete_list":R,j=k.navigation,M=void 0!==j&&j,O=e.sort,V=void 0!==O&&O,B=e.placeHolder,D=e.maxResults,P=void 0===D?5:D,z=e.resultItem,J=(z=void 0===z?{}:z).content,U=void 0!==J&&J,$=z.element,G=void 0===$?"li":$,K=z.idName,Q=void 0===K?"autoComplete_result":K,W=z.className,X=void 0===W?"autoComplete_result":W,Y=e.noResults,Z=e.highlight,ee=void 0!==Z&&Z,te=e.feedback,ie=e.onSelection;this.name=i,this.selector=r,this.data={src:function(){return"function"==typeof a?a():a},key:o,cache:u},this.query=c,this.trigger={event:f,condition:m},this.searchEngine=b,this.threshold=g,this.debounce=A,this.resultsList={render:I,container:x,destination:N||this.inputField,position:F,element:S,idName:H,className:T,navigation:M},this.sort=V,this.placeHolder=B,this.maxResults=P,this.resultItem={content:U,element:G,idName:Q,className:X},this.noResults=Y,this.highlight=ee,this.feedback=te,this.onSelection=ie,this.preInit(),this.inputField}var e,t,i;return e=ne,(t=[{key:"run",value:function(e,t,i){m(!1,t);var n,r,s,a,o,l,u=(n=t)instanceof HTMLInputElement||n instanceof HTMLTextAreaElement?n.value.toLowerCase():n.innerHTML.toLowerCase(),c=(r=u,(s=this.query)&&s.manipulate?s.manipulate(r):r);if(a=this.trigger,o=c,l=this.threshold,a.condition?a.condition(o):o.length>=l&&o.replace(/ /g,"").length){var d={searchEngine:this.searchEngine,highlight:this.highlight,key:this.data.key,sort:this.sort,maxResults:this.maxResults},h=g(c,i,d);if(b(t,{input:u,query:c,results:h},"response"),!i.length)return this.noResults();var f={input:u,query:c,results:h};if(!this.resultsList.render)return this.feedback(e,f);var p={inputField:t,rawInputValue:u,queryInputValue:c,listId:this.resultsList.idName,listClass:this.resultsList.className,itemId:this.resultItem.idName,itemClass:this.resultItem.className,listContainer:this.resultsList.container,itemContent:this.resultItem.content};h.length&&v(h,p,this.onSelection);b(t,{input:u,query:c,results:h},"rendered"),function(e,t){C=-1;var i=t||y;e.addEventListener("keydown",i)}(t,this.resultsList.navigation),document.addEventListener("click",function(e){return m(e.target,t)})}}},{key:"init",value:function(){var i=this;this.data.cache?r(this.data.src(),function(t){b(i.inputField,t,"request"),i.placeHolder&&i.inputField.setAttribute("placeholder",i.placeHolder),i.exec=s(function(e){i.run(e,i.inputField,t)},i.debounce),i.inputField.addEventListener("input",i.exec)}):(this.placeHolder&&this.inputField.setAttribute("placeholder",this.placeHolder),this.exec=s(function(t){r(i.data.src(),function(e){b(i.inputField,e,"request"),i.run(t,i.inputField,e)})},this.debounce),this.inputField.addEventListener("input",this.exec)),b(this.inputField,null,"init")}},{key:"preInit",value:function(){var l=this,u=document;new MutationObserver(function(e,t){var i,n,r,s=c(e);try{for(s.s();!(i=s.n()).done;){var a=i.value;if(u.querySelector(l.selector)){t.disconnect(),l.inputField=u.querySelector(l.selector);var o={inputName:l.name,listId:l.resultsList.idName,listClass:l.resultsList.className,itemId:l.resultItem.idName,itemClass:l.resultItem.className};n=l.inputField,r=o,n.setAttribute("dir","ltr"),n.setAttribute("type","text"),n.setAttribute("spellcheck",!1),n.setAttribute("autocorrect","off"),n.setAttribute("autocomplete","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("title",r.inputName),n.setAttribute("role","combobox"),n.setAttribute("aria-label",r.inputName),n.setAttribute("aria-owns",r.listId),n.setAttribute("aria-haspopup",!0),n.setAttribute("aria-autocomplete","both"),b(l.inputField,{mutation:a},"connect"),l.init()}}}catch(e){s.e(e)}finally{s.f()}}).observe(u,{childList:!0,subtree:!0})}},{key:"attach",value:function(){this.init()}},{key:"detach",value:function(){this.inputField.removeEventListener("input",this.exec),b(this.inputField,null,"detached")}}])&&n(e.prototype,t),i&&n(e,i),ne}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoCompleteJS=b();
