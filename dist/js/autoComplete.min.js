var a,b;a=this,b=function(){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s,o=function(t){return document.querySelector(t)},u=function(){return s.innerHTML=""},l=o,a=function(t){(s=document.createElement("ul")).setAttribute("id","autoComplete_results_list"),t.destination.insertAdjacentElement(t.position,s)},c=function(t){return'<span class="autoComplete_highlighted">'.concat(t,"</span>")},h=function(i,a,o){i.forEach(function(t,e){var n=document.createElement("li"),r=i[e].source[a]||i[e].source;n.setAttribute("data-".concat(o.tag),o.value||r),n.setAttribute("id",r),n.setAttribute("class","autoComplete_result"),n.innerHTML=i[e].match||i[e],s.appendChild(n)})},d=function(n,r,i,a){document.querySelectorAll(".autoComplete_result").forEach(function(t){t.addEventListener("mousedown",function(e){r({query:o(n).value,results:i.map(function(t){return t.source}),selection:i.find(function(t){return(t.source[a]||t.source)===e.target.closest(".autoComplete_result").id}).source}),o(n).value="",u()})})},f=u,p=function(t){document.querySelector("body").innerHTML='<div class="autoComplete_error">'.concat(t,"</div>")};return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=t.threshold||0,this.renderResults=a({destination:t.renderResults?t.renderResults.destination:l(this.selector),position:t.renderResults?t.renderResults.position:"afterend"}),this.placeHolder=t.placeHolder||"",this.maxResults=t.maxResults||5,this.highlight=t.highlight||!1,this.dataAttribute={tag:t.dataAttribute?t.dataAttribute.tag:"autocomplete",value:t.dataAttribute?t.dataAttribute.value:""},this.onSelection=t.onSelection,this.init()}var t,n,r;return t=e,(n=[{key:"search",value:function(t,e){var n=this.highlight,r=e.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var i=[],a=0,o=0;o<r.length;o++){var s=r[o];a<t.length&&s===t[a]&&(s=n?c(s):s,a++),i.push(s)}return a===t.length&&i.join("")}if(r.includes(t)&&n){var u=l(this.selector).value.toLowerCase();return r.replace(u,c(u))}}},{key:"listMatchedResults",value:function(t){var n=this,r=[],i=l(this.selector).value.toLowerCase();t.filter(function(t){var e=n.search(i,t[n.data.key]||t);e&&r.push({match:e,source:t})});var e=r.slice(0,this.maxResults);return h(e,this.data.key,this.dataAttribute),e}},{key:"ignite",value:function(e){var n=this,r=this.selector,i=this.onSelection;l(r).setAttribute("placeholder",this.placeHolder);var a=l(r);a.addEventListener("keyup",function(){f();if(a.value.length>n.threshold&&a.value.replace(/ /g,"").length){var t=n.listMatchedResults(e);i&&d(r,i,t,n.data.key)}})}},{key:"init",value:function(){var e=this;try{var t=this.data.src();t instanceof Promise?t.then(function(t){return e.ignite(t)}):this.ignite(t)}catch(t){p(t)}}}])&&i(t.prototype,n),r&&i(t,r),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
