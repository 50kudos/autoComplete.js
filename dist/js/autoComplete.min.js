var a,b;a=this,b=function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o,a=function(e){return"string"==typeof e?document.querySelector(e):e()},u=function(){return o.innerHTML=""},l=a,s=function(e){(o=document.createElement("ul")).setAttribute("id","autoComplete_results_list"),e.destination.insertAdjacentElement(e.position,o)},c=function(e){return'<span class="autoComplete_highlighted">'.concat(e,"</span>")},h=function(i,s){i.forEach(function(e,t){var n=document.createElement("li"),r=i[t].source[s]||i[t].source;n.setAttribute("autoComplete-data",r),n.setAttribute("class","autoComplete_result"),n.innerHTML=i[t].match||i[t],o.appendChild(n)})},d=function(n,r,i,s){o.querySelectorAll(".autoComplete_result").forEach(function(e){e.addEventListener("mousedown",function(t){r({query:a(n).value,results:i.map(function(e){return e.source}),selection:i.find(function(e){return(e.source[s]||e.source)===t.target.closest(".autoComplete_result").getAttribute("autoComplete-data")}).source}),u()})})},f=u;return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.selector=e.selector||"#autoComplete",this.data={src:function(){return"function"==typeof e.data.src?e.data.src():e.data.src},key:e.data.key},this.searchEngine="loose"===e.searchEngine?"loose":"strict",this.threshold=e.threshold||0,this.renderResults=s({destination:e.renderResults?e.renderResults.destination:l(this.selector),position:e.renderResults?e.renderResults.position:"afterend"}),this.placeHolder=e.placeHolder||"",this.maxResults=e.maxResults||5,this.highlight=e.highlight||!1,this.onSelection=e.onSelection,this.init()}var e,n,r;return e=t,(n=[{key:"search",value:function(e,t){var n=this.highlight,r=t.toLowerCase();if("loose"===this.searchEngine){e=e.replace(/ /g,"");for(var i=[],s=0,o=0;o<r.length;o++){var a=r[o];s<e.length&&a===e[s]&&(a=n?c(a):a,s++),i.push(a)}return s===e.length&&i.join("")}if(r.includes(e)&&n){var u=l(this.selector).value.toLowerCase();return r.replace(u,c(u))}}},{key:"listMatchedResults",value:function(e){var n=this,r=[],i=l(this.selector).value.toLowerCase();e.filter(function(e){var t=n.search(i,e[n.data.key]||e);t&&r.push({match:t,source:e})});var t=r.slice(0,this.maxResults);return h(t,this.data.key),t}},{key:"ignite",value:function(t){var n=this,r=this.selector,i=this.onSelection;l(r).setAttribute("placeholder",this.placeHolder);var s=l(r);s.addEventListener("keyup",function(){f();if(s.value.length>n.threshold&&s.value.replace(/ /g,"").length){var e=n.listMatchedResults(t);i&&d(r,i,e,n.data.key)}})}},{key:"init",value:function(){var t=this,e=this.data.src();e instanceof Promise?e.then(function(e){return t.ignite(e)}):this.ignite(e)}}])&&i(e.prototype,n),r&&i(e,r),t}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
